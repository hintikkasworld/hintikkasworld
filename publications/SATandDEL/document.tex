\documentclass{article}

\usepackage[utf8]{inputenc}     % UTF 8
\usepackage{xspace} %space after a command
\usepackage{eurosym} %for the symbol euro

%\usepackage{listings}
%\lstset{language=Lisp}

%\usepackage[verbose,a4paper,portrait,twoside,twocolumn=false]{geometry}

\usepackage{calc} % for doing computations in LaTEX :)
\usepackage{url}
\usepackage{color}
\usepackage{todonotes}

% Tikz a besoin d'au moins ces versions
\def\xkeyvalversion{1.8}
\def\xcolorversion{2.00}

\usepackage{tikz}
\usetikzlibrary{arrows,patterns,topaths}
% d'autres librairies possibles : matrix, calendar, folding, petri, mindmap, trees, backgrounds, automata, 3d, plotmarks
\usepackage{xparse}

\usepackage{graphicx}


\usepackage{array} % extends environments «array» et «tabular»



% maths things
\usepackage{amsmath}
\usepackage{amssymb}  % \mathbb
\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it} % \mathpzc
\usepackage{mathrsfs} % \mathscr



\usepackage{fancyvrb}
\usepackage[bookmarks={true},bookmarksopen={true}]{hyperref}
\usepackage[normalem]{ulem}
\usepackage{amsmath}

\input{macros.tex}
\renewcommand{\card}[1]{|#1|}


\begin{document}

\title{You never explored such huge Kripke models!}
\author{Authors}

\maketitle


\section{Introduction}

The objective of this paper is to offer debugging possibilities for understand how agents reason about knowledge. To this aim, we need to explore Kripke structures. The problem is that Kripke structures are huge in real applications. Figure~\ref{figure:exploration} shows a screenshot of \emph{Hintikka's World} in the user explores the current Kripke structure in a card game called \emph{Belote}.

\begin{figure}
	\begin{center}
		\includegraphics[width=6cm]{images/hintikkasworld_exploration.png}
	\end{center}
	\caption{Exploration of a Kripke structure.}
\end{figure}

The succinct representation in \emph{Hintikka's World} relies on BDD (binary decision diagrams) \cite{DBLP:conf/ijcai/CharrierGNS19}. However, the tool does not scale up. That is why we propose to rely on \emph{model sampling}  \cite{DBLP:conf/lpar/SharmaGRM18} instead of using BDDs.

\todo{we could also propose solutions to handle reasoning about real numbers like positions of objects}

\section{Background on Dynamic Epistemic Logic}

See \url{http://people.irisa.fr/Francois.Schwarzentruber/hdr/}
\todo{copy here the background on DEL, from HDR of François}


\todo{add succinct description of event models too, from HDR of François}

\section{Succinct description of an epistemic model}

\begin{definition}
An epistemic model is succinctly described by a family of Boolean formulas, one formula $\chi_a(\vec x, \vec x')$ for each agent $a$, where $\vec x$ and $\vec x'$ are both collections of Boolean variables.
\end{definition}

A valuation over $\vec x$ describes a possible world. The formula $\chi_a(\vec x, \vec x')$ describes that the world described a valuation over $\vec x'$ is possible for agent $a$ in the world  the world described a valuation over $\vec x$. 




\begin{example}
	The formula
	$\chi_a(\vec x, \vec x') := (x_1' \lequiv x_1') \land (x_2 \lequiv x_2')$ means that agent $a$ actually knows the truth value of $x_1$ and $x_2$.
\end{example}






\section{Model checking}

The model checking problem is defined as follows:
\begin{itemize}
	\item input: the succinct description of an epistemic model $\modelM$, the description of a world $w$, a formula $\phi$;
	\item output: yes if $\modelM, w \models \phi$, no otherwise.
\end{itemize}


\newcommand\trmltoqbf[2]{tr#1(#2)}

\begin{definition}
	\label{definition:trmltoqbf}
	We define $\trmltoqbf{}{\phi}$ and $
	\trmltoqbf{'}{\phi}$ by mutual induction:
	
	\begin{itemize}
		\item $\trmltoqbf{}{x} = x$; $\trmltoqbf{'}{x} = x'$;
		\item $\trmltoqbf{}{\lnot \phi} = \lnot \trmltoqbf{}{\phi}$; $\trmltoqbf{'}{\lnot \phi} = \lnot \trmltoqbf{'}{\phi}$;
		
		
		\item $\trmltoqbf{}{K_a \phi} = \forall \vec x' (\chi_a(\vec x, \vec x') \limply  \trmltoqbf{'}{\phi})$; 	 $\trmltoqbf{'}{K_a \phi} = \forall \vec x (\chi_a(\vec x', \vec x) \limply  \trmltoqbf{}{\phi})$.
		
	\end{itemize}
	
\end{definition}


$\trmltoqbf\phi$ is the translation of $\phi$ in QBF (close to the standard translation of modal logic in first-order logic \cite{??} \todo{Blackburn}), the relation behind modalities $K_a$ being represented by $\chi_a(\vec x, \vec x')$.


\begin{theorem}
	$\modelM, w \models \phi$ iff $\trmltoqbf{}{\phi} \land descr(w)$ is QBF-true.
\end{theorem}


\section{Exploration of Huge Kripke structures}


In this section, we aim at solving the following problem.

\begin{itemize}
	\item input: the succinct description of an epistemic model $\modelM$, the description of a world $w$; an agent $a$;
	\item output: a \emph{random} description of a world $u$ such that $u \in R_a(w)$.
\end{itemize}

The idea is to sample a valuation for variables $\vec x'$ such that $\chi_a(\vec x, \vec x')$ where $\vec x$ describes the world $w$.
\todo{Rely on one of the tools of \cite{DBLP:conf/lpar/SharmaGRM18}, but they do not capture QBF, that is needed as we will see}



\section{Succinct description of epistemic model after actions}

In this section, we explain how to compute a succinct description of the epistemic model obtained after the execution of an action. 

\begin{itemize}
	\item input: the succinct description of an epistemic model $\modelM$, the description of a world $w$ in $\modelM$; the description of an event model $\eventmodel$, the description of an event $\event$ in $\eventmodel$;
	\item output: the succinct description of the epistemic model $\modelM \otimes \eventmodel$, the description of the world $(w, \event)$.
\end{itemize}



\subsection{Public announcements}



Let us consider an epistemic model $\modelM$ described by:
\begin{itemize}
	\item $\chi_a(\vec x, \vec x')$ for all agents $a$.
\end{itemize}


The epistemic model after the announcement of a propositional formula $\phi$ is described by:
\begin{itemize}
	\item $\chi_a(\vec x, \vec x')\land \phi'$ for all agents $a$.
\end{itemize}

where $\phi'$ is the formula obtained from $\phi$ by replacing variables $x$ by their copies $x'$.
The epistemic model after the announcement of a modal formula $\phi$ is described by:
\begin{itemize}
	\item $\chi_a(\vec x, \vec x') \land \trmltoqbf{'}\phi$ for all agents $a$.
\end{itemize}

where $\trmltoqbf{'}\phi$ is defined in Definition~\ref{definition:trmltoqbf}.



\begin{example}
Suppose that the relation for an agent $a$ is represented by $\chi_a(\vec x, \vec x')$. After the announcement of $K_b \phi_1$, the relation for agent $b$ is represented by:


$$\chi_a(\vec x, \vec x') \land (\forall \vec x (\chi_b(\vec x', \vec x) \limply \trmltoqbf{}{\phi_1})$$

After the announcement of $K_a \phi_2$, the relation for agent $a$ is represented by:

\begin{center}
$[\chi_a(\vec x, \vec x') \land (\forall \vec x (\chi_b(\vec x', \vec x) \limply \trmltoqbf{}{\phi_1})] \land $

$\forall \vec x ([\chi_a(\vec x', \vec x) \land (\forall \vec x' (\chi_b(\vec x, \vec x') \limply \trmltoqbf{'}{\phi_1})] \limply \trmltoqbf{}{\phi_2})$
	
\end{center}


\end{example}







\subsection{Public actions}

Let us consider an epistemic model $\modelM$ described by:
\begin{itemize}
	\item a Boolean formula $\chi_a(\vec x, \vec x')$ for all agents $a$, that represents epistemic relation for agent $a$;
	\item a valuation $w$ representing the real world;
\end{itemize}


Let us consider a public action of Boolean precondition $\phi$ and postconditions $\set{x_1 := \phi_1, \dots, x_n := \phi_n}$ where $\phi_1, \dots, \phi_n$ are Boolean. The epistemic model obtained after executing that particular public action is described by:
\begin{itemize}
%	\item  $\chi_p(\vec x := \vec y) \land \phi(\vec x := \vec y) \land \lbigand_{i=1..n} [x_i \lequiv \phi_i(\vec x := \vec y)]$ 
	\item $\chi_a(\vec y, \vec y')  \land \phi(\vec x := \vec y) \land \lbigand_{i=1..n} [x_i \lequiv \phi_i(\vec x := \vec y)] \land \lbigand_{i=1..n} [x_i' \lequiv \phi_i(\vec x := \vec y')]$ for all agents $a$.
	\item the valuation $[y_1 := w[x_1], \dots, x_1 := (w \models \phi_1), \dots]$
\end{itemize}










%
%
%\begin{itemize}
%	\item input: the description of the pointed initial epistemic model $\modelM, w$, the description of an ambiant $\eventmodel$, a finite sequence of events $\event_1, \dots, \event_n$;
%	\item output: 
%\end{itemize}



\fbox{\begin{minipage}{10cm}
		Tasks to do (if you agree, of course)
		
		~
		
		
		Frédéric
		\begin{itemize}
			\item Verify that "exactly 5 propositions among 8 are true" is efficient
			\item Connection with Sampling method
		\end{itemize}
	
	
	~
	
	Pâris
	
	\begin{itemize}
		\item Make Touist as a webservice
		\item Data structure in TypeScript
		\item Design an example
	\end{itemize}




~

François

\begin{itemize}
	\item Think about the succinct descriptions
%	\item Can we sample valuations of a QBF formula? Not sure. 
%	\item Touist handles QBF, right? yes
\end{itemize}
	\end{minipage}}







\bibliographystyle{plain}
\bibliography{biblio}


\end{document}



